<div class="bg-base-200 min-h-screen text-gray-700 <%= 'brightness-75' if current_user.not_started? %>">
  <%= render 'shared/login_check' %>
  <%= render 'shared/flash_message' %>
  <div class="flex border-b-4 border-base-300">
    <div class="flex-1 font-light mx-4 m-2 text-4xl drop-shadow-2xl"><%= link_to "ãƒ—ãƒ­ãƒƒãƒˆä¸€è¦§", plots_path, class: "text-3xl" %></div>
  </div>
  <div class="">
    <div class="grid grid-cols-2 md:grid-cols-3 xl:grid-cols-4 2xl:grid-cols-5">
      <div class="m-2 mx-4 justify-self-end col-span-2 md:col-span-3 xl:col-span-4 2xl:col-span-5"><%= render 'search_form' %></div>
      <%= render @plots %>
      <div class="stack <%= 'brightness-100' if current_user.running? %>">
        <%= link_to new_plot_path, class: "card-link" do %>
          <div class="card m-2 sm:m-4 h-40 h-40 bg-gradient-to-b from-white to-amber-50 shadow-2xl relative flex flex-col justify-center items-center hover:rotate-6">
            <p class="text-sm"><i class="bi bi-plus-lg " style="font-size: 2rem;"></i></p>
          </div>
        <% end %>
        <div class="card m-2 xs:m-4 h-40 h-40 bg-pink-100"></div>
        <div class="card m-2 xs:m-4 h-40 h-40 bg-cyan-100"></div>
        <div class="card m-2 xs:m-4 h-40 h-40 bg-orange-100"></div>
        <div class="card m-2 xs:m-4 h-40 h-40 bg-teal-100"></div>
      </div>
    </div>
  </div>
</div>

<%= render 'shared/footer' %>

<div class="fixed bottom-0 right-0 m-8 z-20">
  <%= link_to new_plot_path, class: "shadow-2xl rounded-full bg-neutral-400 hover:bg-neutral-500 text-white font-bold p-10 flex items-center justify-center" do %>
    <i class="bi bi-plus-lg fixed" style="font-size: 1.5rem;"></i>
  <% end %>
</div>

<% if current_user.not_started? %>
<input type="checkbox" id="my-modal" class="modal-toggle" checked />
<div class="modal">
  <div class="modal-box">
    <div class="text-xl font-bold m-2 mb-4 border-b border-gray-500 text-gray-700">ã‚¢ã‚«ã‚¦ãƒ³ãƒˆä½œæˆã‚ã‚ŠãŒã¨ã†ã”ã–ã„ã¾ã™ï¼ğŸ‰</div>
    <div class="text-sm m-2 my-4 text-gray-700">MidPlotã§ã¯ã€çš†ã•ã‚“ãŒã‚¹ãƒ ãƒ¼ã‚ºã‹ã¤æ¥½ã—ããƒ—ãƒ­ãƒƒãƒˆåˆ¶ä½œã‚¢ãƒ—ãƒªã‚’åˆ©ç”¨ã§ãã‚‹ã‚ˆã†ã€ãƒãƒ¥ãƒ¼ãƒˆãƒªã‚¢ãƒ«ã‚’ç”¨æ„ã—ã¦ã„ã¾ã™ã€‚</div>
    <div class="text-sm m-2 my-4 text-gray-700">â€»ä»Šå›ã‚¹ã‚­ãƒƒãƒ—ã—ãŸå ´åˆã§ã‚‚ã€ãƒã‚¤ãƒšãƒ¼ã‚¸ã‹ã‚‰å†åº¦ãƒãƒ¥ãƒ¼ãƒˆãƒªã‚¢ãƒ«ã‚’å®Ÿè¡Œã™ã‚‹ã“ã¨ãŒã§ãã¾ã™ã€‚</div>
    <div class="flex justify-between mt-5">
      <%= button_to  'ã‚¹ã‚­ãƒƒãƒ—', complete_tutorial_path(current_user), class: "btn m-2" , method: :patch %>
      <%= button_to  'ãƒãƒ¥ãƒ¼ãƒˆãƒªã‚¢ãƒ«ã¸', start_tutorial_path(current_user), class: "btn m-2" , method: :patch %>
    </div>
  </div>
</div>
<% elsif current_user.running? %>
<div class="fixed bg-base-100 shadow-xl bottom-28 m-8 z-20 h-52 sm:h-40 w-11/12 max-w-5xl border-2 rounded-lg border-stone-800">
  <div class="chat chat-start mt-2">
    <div class="chat-image">
      <%= image_tag("booknekosan.png", width: '120px', height: '120px', class: "bottom-0") %>
    </div>
    <div id="text", class="chat-bubble chat-bubble-secondary"></div>
  </div>
  <div class="-my-8 m-2 flex justify-end items-end">
    <%= button_to  'ãƒãƒ¥ãƒ¼ãƒˆãƒªã‚¢ãƒ«ã‚’çµ‚äº†ã™ã‚‹', complete_tutorial_path(current_user), class: "btn btn-sm m-2" , method: :patch %>
    <div id="increment-btn", class="btn btn-sm m-2">å‰ã¸</div>
    <div id="decrement-btn", class="btn btn-sm m-2">æ¬¡ã¸</div>
  </div>
</div>

<script>
const incrementBtn = document.getElementById('increment-btn');
const decrementBtn = document.getElementById('decrement-btn');
const textDiv = document.getElementById('text');

const texts = [
  'ãƒãƒ¥ãƒ¼ãƒˆãƒªã‚¢ãƒ«ã‚’å§‹ã‚ã¦ãã‚Œã¦ã‚ã‚ŠãŒã¨ã†ã€‚ã¾ãšã¯ã€ï¼‹ã‚«ãƒ¼ãƒ‰ã‚’ã‚¯ãƒªãƒƒã‚¯ã—ã¦æ–°ã—ã„ãƒ—ãƒ­ãƒƒãƒˆã‚’ä½œæˆã—ã‚ˆã†ï¼',
  'å³ä¸‹ã®ä¸¸ã„ï¼‹ãƒœã‚¿ãƒ³ã§ã‚‚ä½œæˆã§ãã‚‹ã‚ˆï¼'
];
let currentIndex = 0;

textDiv.textContent = texts[currentIndex];
updateButtonVisibility();

incrementBtn.addEventListener('click', () => {
  currentIndex = Math.max(currentIndex - 1, 0);
  textDiv.textContent = texts[currentIndex];
  updateButtonVisibility();
});

decrementBtn.addEventListener('click', () => {
  currentIndex = Math.min(currentIndex + 1, texts.length - 1);
  textDiv.textContent = texts[currentIndex];
  updateButtonVisibility();
});

function updateButtonVisibility() {
  if (currentIndex === 0) {
    incrementBtn.setAttribute('disabled', true);
    incrementBtn.classList.add('opacity-50', 'cursor-not-allowed');
  } else {
    incrementBtn.removeAttribute('disabled');
    incrementBtn.classList.remove('opacity-50', 'cursor-not-allowed');
  }

  if (currentIndex === texts.length - 1) {
    decrementBtn.setAttribute('disabled', true);
    decrementBtn.classList.add('opacity-50', 'cursor-not-allowed');
  } else {
    decrementBtn.removeAttribute('disabled');
    decrementBtn.classList.remove('opacity-50', 'cursor-not-allowed');
  }
}
</script>
<% end %>